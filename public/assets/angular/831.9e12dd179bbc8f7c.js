"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[831],{831:(me,d,i)=>{i.r(d),i.d(d,{GoldenTicketModule:()=>ce});var m=i(6019),f=i(9133),M=i(6113),b=i(4625),A=i(7615),g=i(4382),c=i(4762),u=i(2968),p=i(2262),l=i(240),S=i(1168),_=i(9190),x=i(7182),e=i(3668),h=i(5304),P=i(4099),D=i(238);let J=(()=>{class n{constructor(t){this.apiService=t,this.formulasGetResponse=new P.X([]),this.formulasGetResponse$=this.formulasGetResponse.asObservable()}getFormulas(){return(0,c.mG)(this,void 0,void 0,function*(){return yield this.apiService.getData("formulas").then(t=>t.json()).then(t=>{this.orders=t,this.formulasGetResponse.next(t)}),this.orders})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(D.s))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var N=i(9978),F=i(7635),y=i(515),v=i(8167),T=i(6400),C=i(86),Y=i(1136),R=i(4643),Z=i(6731),G=i(9009),O=i(904),Q=i(3530),k=i(9112);function U(n,r){if(1&n&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function L(n,r){if(1&n&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function B(n,r){1&n&&e._UZ(0,"mat-progress-bar",26)}function z(n,r){1&n&&(e.TgZ(0,"th",27),e.TgZ(1,"mat-checkbox",28),e.NdJ("click",function(o){return o.stopPropagation()}),e.qZA(),e.qZA())}function I(n,r){1&n&&(e.TgZ(0,"td",29),e.TgZ(1,"mat-checkbox",28),e.NdJ("click",function(o){return o.stopPropagation()}),e.qZA(),e.qZA())}function $(n,r){1&n&&e._UZ(0,"th",30)}function H(n,r){if(1&n&&(e.TgZ(0,"td",31),e._UZ(1,"img",32),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.MGl("src","http://i.pravatar.cc/30?u=",t.name,"",e.LSH)}}function j(n,r){if(1&n&&(e.TgZ(0,"th",37),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.name,"")}}function X(n,r){if(1&n&&(e.TgZ(0,"td",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit,o=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t[o.property]," ")}}function W(n,r){if(1&n&&(e.ynx(0,34),e.YNc(1,j,2,1,"th",35),e.YNc(2,X,2,1,"td",36),e.BQk()),2&n){const t=e.oxw().$implicit;e.Q6J("matColumnDef",t.property)}}function E(n,r){if(1&n&&(e.ynx(0),e.YNc(1,W,3,1,"ng-container",33),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.isModelProperty)}}function V(n,r){1&n&&e._UZ(0,"th",39)}function w(n,r){if(1&n&&(e.TgZ(0,"td",29),e.TgZ(1,"button",40),e.NdJ("click",function(o){return o.stopPropagation()}),e.TgZ(2,"mat-icon"),e._uU(3,"more_horiz"),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("matMenuTriggerFor",t.actionsMenu)}}function K(n,r){1&n&&e._UZ(0,"tr",41)}function q(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",42),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().updateCustomer(s)}),e.qZA()}}const ee=[{path:"",component:(()=>{class n{constructor(t,o,a){this.dialog=t,this.goldenTicketService=o,this.campaignService=a,this.isLoading=!1,this.totalRows=0,this.pageSize=25,this.currentPage=0,this.pageSizeOptions=[5,10,25,100],this.filters={},this.month=null,this.months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.year=null,this.years=[],this.notyf=new x.Iq,this.columns=[{name:"Checkbox",property:"checkbox",visible:!1},{name:"Month",property:"month",visible:!0,isModelProperty:!0},{name:"Year",property:"year",visible:!0,isModelProperty:!0},{name:"Initials",property:"initials",visible:!0,isModelProperty:!0},{name:"Rebills",property:"rebills",visible:!0,isModelProperty:!0},{name:"Cycle 1 %",property:"cycle_1_per",visible:!0,isModelProperty:!0},{name:"Cycle 2",property:"cycle_2",visible:!0,isModelProperty:!0},{name:"Cycle 2 %",property:"cycle_2_per",visible:!0,isModelProperty:!0},{name:"Cycle 3+",property:"cycle_3_plus",visible:!0,isModelProperty:!0},{name:"Cycle 3+ %",property:"cycle_3_plus_per",visible:!0,isModelProperty:!0},{name:"Avg Ticket",property:"avg_ticket",visible:!0,isModelProperty:!0},{name:"Revenue",property:"revenue",visible:!0,isModelProperty:!0},{name:"Refund",property:"refund",visible:!0,isModelProperty:!0},{name:"Refund Rate",property:"refund_rate",visible:!0,isModelProperty:!0},{name:"CBs",property:"CBs",visible:!0,isModelProperty:!0},{name:"CB %",property:"CB_per",visible:!0,isModelProperty:!0},{name:"CB $",property:"CB_currency",visible:!0,isModelProperty:!0},{name:"Fulfillment",property:"fulfillment",visible:!0,isModelProperty:!0},{name:"Processing",property:"processing",visible:!0,isModelProperty:!0},{name:"CPA",property:"cpa",visible:!0,isModelProperty:!0},{name:"CPA AVG",property:"cpa_avg",visible:!0,isModelProperty:!0},{name:"Net",property:"net",visible:!0,isModelProperty:!0},{name:"CLV",property:"clv",visible:!0,isModelProperty:!0}],this.getYearsArray(new Date)}get visibleColumns(){return this.columns.filter(t=>t.visible).map(t=>t.property)}getYearsArray(t){for(var o=t.getFullYear(),a=o;a>o-5;a--)this.years.unshift(a);for(a=o+1;a<o+5;a++)this.years.push(a);console.log("years",this.years)}ngOnInit(){this.getSubscription=this.campaignService.ticketsGetResponse$.subscribe(t=>this.manageGetResponse(t)),this.getData(),this.dataSource=new l.by}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}pageChanged(t){this.pageSize=t.pageSize,this.currentPage=t.pageIndex,this.getData()}getData(){return(0,c.mG)(this,void 0,void 0,function*(){this.isLoading=!0,yield this.campaignService.getGoldenTicketData().then(t=>{this.tickets=t.data,this.dataSource.data=t.data,setTimeout(()=>{}),this.isLoading=!1},t=>{this.isLoading=!1})})}manageGetResponse(t){t.status?(this.tickets=t.data,this.dataSource.data=t.data,setTimeout(()=>{}),this.isLoading=!1):this.isLoading=!1}onFilterChange(t){!this.dataSource||(t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t)}filterRecord(){return(0,c.mG)(this,void 0,void 0,function*(){null!=this.month||null!=this.year?yield this.campaignService.filterGoldenTicket(this.month,this.year).then(t=>{0!=t.data.length?(this.tickets=t.data,this.dataSource.data=t.data,this.isLoading=!1,this.notyf.success("Data Found Successfully")):this.notyf.error("Oops! No Data Found")},t=>{this.isLoading=!1,this.notyf.error(t.message)}):this.notyf.error("Please select filter options")})}addCustomMonth(){return(0,c.mG)(this,void 0,void 0,function*(){this.month&&this.year?yield this.campaignService.addCurrentMonth(this.month,this.year).then(t=>{1==t.status?(this.notyf.success(t.message),this.getData()):this.notyf.success(t.message)},t=>{this.isLoading=!1,this.notyf.error(t.message)}):this.notyf.error("Select Month and Year")})}addCurrentMonth(){return(0,c.mG)(this,void 0,void 0,function*(){var t=this.months[(new Date).getMonth()],o=(new Date).getFullYear();yield this.campaignService.addCurrentMonth(t,o).then(a=>{1==a.status?(this.notyf.success(a.message),this.getData()):this.notyf.success(a.message)},a=>{this.isLoading=!1,this.notyf.error(a.message)})})}resetFilters(){this.month=null,this.year=null}refresh(){this.resetFilters(),this.getData()}ngOnDestroy(){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.uw),e.Y36(J),e.Y36(N.U))},n.\u0275cmp=e.Xpm({type:n,selectors:[["fury-golden-ticket"]],viewQuery:function(t,o){if(1&t&&(e.Gf(u.NW,7),e.Gf(p.YE,7)),2&t){let a;e.iGM(a=e.CRH())&&(o.paginator=a.first),e.iGM(a=e.CRH())&&(o.sort=a.first)}},inputs:{columns:"columns"},decls:42,vars:15,consts:[["fxLayout","","fxLayoutAlign","space-between center"],["appearance","fill"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill",1,"pl-1"],["mat-raised-button","","color","warn",1,"ml-1",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","accent",1,"ml-1",3,"click"],["mode","simple"],["name","Golden Ticket",3,"columns","filterChange"],["mode","indeterminate",4,"ngIf"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","checkbox"],["class","actions-cell","mat-header-cell","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["matColumnDef","image"],["class","image-cell","mat-header-cell","",4,"matHeaderCellDef"],["class","image-cell","mat-cell","",4,"matCellDef"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",3,"length","pageIndex","pageSize","pageSizeOptions","page"],["paginator",""],[3,"value"],["mode","indeterminate"],["mat-header-cell","",1,"actions-cell"],["color","primary",3,"click"],["mat-cell","",1,"actions-cell"],["mat-header-cell","",1,"image-cell"],["mat-cell","",1,"image-cell"],[3,"src"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"fury-page-layout-content",0),e.TgZ(1,"div"),e.TgZ(2,"mat-form-field",1),e.TgZ(3,"mat-label"),e._uU(4,"Select Month"),e.qZA(),e.TgZ(5,"mat-select",2),e.NdJ("valueChange",function(s){return o.month=s}),e.YNc(6,U,2,2,"mat-option",3),e.qZA(),e.qZA(),e.TgZ(7,"mat-form-field",4),e.TgZ(8,"mat-label"),e._uU(9,"Select Year "),e.qZA(),e.TgZ(10,"mat-select",2),e.NdJ("valueChange",function(s){return o.year=s}),e.YNc(11,L,2,2,"mat-option",3),e.qZA(),e.qZA(),e.TgZ(12,"button",5),e.NdJ("click",function(){return o.filterRecord()}),e._uU(13,"Apply"),e.qZA(),e.TgZ(14,"button",5),e.NdJ("click",function(){return o.resetFilters()}),e._uU(15,"Reset"),e.qZA(),e.TgZ(16,"button",5),e.NdJ("click",function(){return o.addCustomMonth()}),e._uU(17,"Add"),e.qZA(),e.qZA(),e.TgZ(18,"div"),e.TgZ(19,"button",6),e.NdJ("click",function(){return o.refresh()}),e._uU(20,"Refresh"),e.qZA(),e.TgZ(21,"button",7),e.NdJ("click",function(){return o.addCurrentMonth()}),e._uU(22,"Add Current Month"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"fury-page-layout",8),e.TgZ(24,"fury-page-layout-content"),e.TgZ(25,"fury-list",9),e.NdJ("filterChange",function(s){return o.onFilterChange(s)}),e.YNc(26,B,1,0,"mat-progress-bar",10),e.TgZ(27,"table",11),e.ynx(28,12),e.YNc(29,z,2,0,"th",13),e.YNc(30,I,2,0,"td",14),e.BQk(),e.ynx(31,15),e.YNc(32,$,1,0,"th",16),e.YNc(33,H,2,1,"td",17),e.BQk(),e.YNc(34,E,2,1,"ng-container",18),e.ynx(35,19),e.YNc(36,V,1,0,"th",20),e.YNc(37,w,4,1,"td",14),e.BQk(),e.YNc(38,K,1,0,"tr",21),e.YNc(39,q,1,0,"tr",22),e.qZA(),e.TgZ(40,"mat-paginator",23,24),e.NdJ("page",function(s){return o.pageChanged(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Q6J("value",o.month),e.xp6(1),e.Q6J("ngForOf",o.months),e.xp6(4),e.Q6J("value",o.year),e.xp6(1),e.Q6J("ngForOf",o.years),e.xp6(13),e.Q6J("@fadeInUp",void 0),e.xp6(1),e.Q6J("columns",o.columns),e.xp6(1),e.Q6J("ngIf",o.isLoading),e.xp6(1),e.Q6J("dataSource",o.dataSource),e.xp6(7),e.Q6J("ngForOf",o.columns),e.xp6(4),e.Q6J("matHeaderRowDef",o.visibleColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.visibleColumns),e.xp6(1),e.Q6J("length",o.totalRows)("pageIndex",o.currentPage)("pageSize",o.pageSize)("pageSizeOptions",o.pageSizeOptions))},directives:[F.d,y.xw,y.Wh,v.KE,v.hX,T.gD,m.sg,C.lW,Y.N,R.n,m.O5,l.BZ,p.YE,l.w1,l.fO,l.Dz,l.as,l.nj,u.NW,Z.ey,G.pW,l.ge,O.oG,l.ev,p.nU,Q.p6,k.Hw,l.XQ,l.Gk],styles:[".pl-1[_ngcontent-%COMP%]{padding-left:10px}.pt-1[_ngcontent-%COMP%]{padding-left:10px}.pb-1[_ngcontent-%COMP%]{padding-left:10px}.pr-1[_ngcontent-%COMP%]{padding-left:10px}.ml-1[_ngcontent-%COMP%]{margin-left:10px}"],data:{animation:[S.M,_.X]}}),n})()}];let te=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[g.Bz.forChild(ee)],g.Bz]}),n})();var ne=i(9198),oe=i(6153),ie=i(138),ae=i(9859),re=i(8727),le=i(3050),se=i(8898);let ce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[m.ez,te,f.u5,f.UX,A.q,ne.Z,oe.o9,h.Is,ie.c,C.ot,k.Ps,ae.Fk,T.LD,re.FA,Z.XK,le.To,se.IJ,b.p,M.J,l.p0,u.TU,G.Cv]]}),n})()}}]);